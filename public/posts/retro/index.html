<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Retro - THM | Shebu</title>
<meta name="keywords" content="IIS, CVE-2019-1388, xfreerdp, tryhackme">
<meta name="description" content="Description - New high score!
There are two distinct paths that can be taken on Retro. One requires significantly less trial and error, however, both will work.
Room Retro OS Windows Difficulty Hard Room Link https://tryhackme.com/room/retro Creator DarkStar7471 Enumeration - Task 1 - Pwn
Nmap
# Nmap 7.91 scan initiated Mon Aug 9 02:32:51 2021 as: nmap -sC -sV -v -p 80,3389 -oN retro.nmap retro.thm Nmap scan report for retro.thm (10.">
<meta name="author" content="Shebu">
<link rel="canonical" href="https://sh3bu.github.io/posts/retro/">
<meta name="google-site-verification" content="GTM-NNK933J">
<link crossorigin="anonymous" href="/assets/css/stylesheet.7140587df96a2b1a49eb723fa7063dc0c641a6cb638f3140e8d3beb4deae4f5c.css" integrity="sha256-cUBYfflqKxpJ63I/pwY9wMZBpstjjzFA6NO&#43;tN6uT1w=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://sh3bu.github.io/img/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://sh3bu.github.io/img/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://sh3bu.github.io/img/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://sh3bu.github.io/img/apple-touch-icon.png">
<link rel="mask-icon" href="https://sh3bu.github.io/img/apple-touch-icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-T6XL9391MH"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-T6XL9391MH', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="Retro - THM" />
<meta property="og:description" content="Description - New high score!
There are two distinct paths that can be taken on Retro. One requires significantly less trial and error, however, both will work.
Room Retro OS Windows Difficulty Hard Room Link https://tryhackme.com/room/retro Creator DarkStar7471 Enumeration - Task 1 - Pwn
Nmap
# Nmap 7.91 scan initiated Mon Aug 9 02:32:51 2021 as: nmap -sC -sV -v -p 80,3389 -oN retro.nmap retro.thm Nmap scan report for retro.thm (10." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sh3bu.github.io/posts/retro/" />
<meta property="og:image" content="https://sh3bu.github.io/img/retro.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-16T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-11-16T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://sh3bu.github.io/img/retro.png" />
<meta name="twitter:title" content="Retro - THM"/>
<meta name="twitter:description" content="Description - New high score!
There are two distinct paths that can be taken on Retro. One requires significantly less trial and error, however, both will work.
Room Retro OS Windows Difficulty Hard Room Link https://tryhackme.com/room/retro Creator DarkStar7471 Enumeration - Task 1 - Pwn
Nmap
# Nmap 7.91 scan initiated Mon Aug 9 02:32:51 2021 as: nmap -sC -sV -v -p 80,3389 -oN retro.nmap retro.thm Nmap scan report for retro.thm (10."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://sh3bu.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Retro - THM",
      "item": "https://sh3bu.github.io/posts/retro/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Retro - THM",
  "name": "Retro - THM",
  "description": "Description - New high score!\nThere are two distinct paths that can be taken on Retro. One requires significantly less trial and error, however, both will work.\nRoom Retro OS Windows Difficulty Hard Room Link https://tryhackme.com/room/retro Creator DarkStar7471 Enumeration - Task 1 - Pwn\nNmap\n# Nmap 7.91 scan initiated Mon Aug 9 02:32:51 2021 as: nmap -sC -sV -v -p 80,3389 -oN retro.nmap retro.thm Nmap scan report for retro.thm (10.",
  "keywords": [
    "IIS", "CVE-2019-1388", "xfreerdp", "tryhackme"
  ],
  "articleBody": "Description - New high score!\nThere are two distinct paths that can be taken on Retro. One requires significantly less trial and error, however, both will work.\nRoom Retro OS Windows Difficulty Hard Room Link https://tryhackme.com/room/retro Creator DarkStar7471 Enumeration - Task 1 - Pwn\nNmap\n# Nmap 7.91 scan initiated Mon Aug 9 02:32:51 2021 as: nmap -sC -sV -v -p 80,3389 -oN retro.nmap retro.thm Nmap scan report for retro.thm (10.10.39.189) Host is up (0.22s latency). PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 | http-methods: | Supported Methods: OPTIONS TRACE GET HEAD POST |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 |_http-title: IIS Windows Server 3389/tcp open ms-wbt-server Microsoft Terminal Services | rdp-ntlm-info: | Target_Name: RETROWEB | NetBIOS_Domain_Name: RETROWEB | NetBIOS_Computer_Name: RETROWEB | DNS_Domain_Name: RetroWeb | DNS_Computer_Name: RetroWeb | Product_Version: 10.0.14393 |_ System_Time: 2021-08-09T06:32:02+00:00 | ssl-cert: Subject: commonName=RetroWeb | Issuer: commonName=RetroWeb | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2021-08-08T06:21:24 | Not valid after: 2022-02-07T06:21:24 | MD5: 55a1 3e5f 9623 5cf0 be0e 8565 b1bb 00a5 |_SHA-1: a0cf f59d 1e77 e914 7eeb 810e b04d a310 dc2c c90e |_ssl-date: 2021-08-09T06:32:06+00:00; -1m00s from scanner time. Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -1m00s, deviation: 0s, median: -1m00s Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Mon Aug 9 02:33:06 2021 -- 1 IP address (1 host up) scanned in 15.70 seconds As you can see there are 2 ports open :\nPort 80 - http - Microsoft IIS httpd 10.0\nPort 3389 - ms-wbt-server - Microsoft Terminal Services\nWeb Enumeration\nVisitinng the webpage at port 80, we get a default IIS page üëáüèª\nTo enumerate the hidden directories , I used ffuf\n‚îå‚îÄ‚îÄ(shebu„âøkali)-[~/Desktop/thm/retro] ‚îî‚îÄ$ ffuf -c -w /usr/share/wordlists/dirbuster/medium.txt -u http://retro.thm/FUZZ -fc 403,404 -fs 703 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive \u003c3 ________________________________________________ :: Method : GET :: URL : http://retro.thm/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/dirbuster/medium.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 :: Filter : Response status: 403,404 :: Filter : Response size: 703 ________________________________________________ retro [Status: 301, Size: 146, Words: 9, Lines: 2] Qn 1 üéØ- What is the hidden directory which the website lives on? - /retro Shell as Wade - On visiting the /retro directory we get this webpage üëáüèª\nSeems like a fancy looking blog page .Taking a close look at the page , you can see that the author of the blog posts is Wade\nWade might possibly be a username which may come handy later .Lets note it down and enumerate further !\nWhile looking at all the posts ,one particular post is quite interesting üëáüèª\nThis posts has some comments on it !\nCould that be Wade‚Äôs password? Let‚Äôs try logging in using xfreerdp !\nxfreerdp /u:wade /p:parzival /cert:ignore /v:retro.thm And we‚Äôre in !!\nGrab the user.txtüö©\nShell as administrator - The first thing I checked was recycle bin , It contained hhupd.exe file .\nhhupd.exe is an executable file that is part of the Microsoft Press Computer-Lexikon program developed by Microsoft Press .\nThe next thing I noticed is there was Google Chrome shortcut in desktop which was weird !\nOpening Chrome , we could see that the author of the box has a bookmark called NVD-CVE-2019-1388\nMaybe this is what we need inorder to escalate out privileges to root ! So the CVE is CVE-2019-1388\nLets use some google fu to read more on this vulnerability ,\nThis blog post explains it in quite detailed and clear manner on how to exploit this vulnerability -\nhttps://www.zerodayinitiative.com/blog/2019/11/19/thanksgiving-treat-easy-as-pie-windows-7-secure-desktop-escalation-of-privilege\nFor this exploit to work we need to have hhupd.exe application on our system , which we already found in recycle bin .Restore the application and follow the steps as mentioned in the blog post .\n1. Run the \"hhupd.exe\" application as administrator 2. Click on \"Show more details\" arrow 3. Click the link \"Show information about this publisher's certificate\" 4. Click the link \"VeriSign Commercial Software Publishers CA\" 5. Now the certificate issuer's website should have been opened on internet explorer! 6. Press \"CTRL+S\" to save the webpage , a dialog box appears 7. Type \"cmd.exe\" on the File name box and hit ENTER ! Voila ! We get a command prompt with admin privileges ! Navigate to C:\\Users\\Administrator\\Desktop\nGrab the root.txt üö©\n",
  "wordCount" : "783",
  "inLanguage": "en",
  "image":"https://sh3bu.github.io/img/retro.png","datePublished": "2021-11-16T00:00:00Z",
  "dateModified": "2021-11-16T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Shebu"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sh3bu.github.io/posts/retro/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Shebu",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sh3bu.github.io/img/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://sh3bu.github.io/" accesskey="h" title="Shebu&#39;s Blog (Alt + H)">
                <img src="https://sh3bu.github.io/img/goku.png" alt="" aria-label="logo"
                    height="90">Shebu&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://sh3bu.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://sh3bu.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://sh3bu.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://sh3bu.github.io/">Home</a>&nbsp;¬ª&nbsp;<a href="https://sh3bu.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Retro - THM
    </h1>
    <div class="post-meta"><span title='2021-11-16 00:00:00 +0000 UTC'>November 16, 2021</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;Shebu

</div>
  </header> 
<figure class="entry-cover">
        <img loading="lazy" srcset="https://sh3bu.github.io/posts/retro/img/retro_hu60411f585a42445c807c86f638ca6188_133874_360x0_resize_box_3.png 360w ,https://sh3bu.github.io/posts/retro/img/retro_hu60411f585a42445c807c86f638ca6188_133874_480x0_resize_box_3.png 480w ,https://sh3bu.github.io/posts/retro/img/retro_hu60411f585a42445c807c86f638ca6188_133874_720x0_resize_box_3.png 720w ,https://sh3bu.github.io/posts/retro/img/retro_hu60411f585a42445c807c86f638ca6188_133874_1080x0_resize_box_3.png 1080w ,https://sh3bu.github.io/posts/retro/img/retro.png 1200w" 
            sizes="(min-width: 768px) 720px, 100vw" src="https://sh3bu.github.io/posts/retro/img/retro.png" alt="" 
            width="1200" height="628">
        <p><text></p>
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#description--" aria-label="Description -">Description -</a></li>
                <li>
                    <a href="#enumeration--" aria-label="Enumeration -">Enumeration -</a></li>
                <li>
                    <a href="#shell-as-wade--" aria-label="Shell as Wade -">Shell as Wade -</a></li>
                <li>
                    <a href="#shell-as-administrator--" aria-label="Shell as administrator -">Shell as administrator -</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="description--">Description -<a hidden class="anchor" aria-hidden="true" href="#description--">#</a></h2>
<hr>
<p><strong>New high score!</strong></p>
<p><strong>There are two distinct paths that can be taken on Retro. One requires significantly less trial and error, however, both will work.</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>Room</strong></th>
<th>Retro</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>OS</strong></td>
<td>Windows</td>
</tr>
<tr>
<td style="text-align:center"><strong>Difficulty</strong></td>
<td>Hard</td>
</tr>
<tr>
<td style="text-align:center"><strong>Room Link</strong></td>
<td><a href="https://tryhackme.com/room/retro">https://tryhackme.com/room/retro</a></td>
</tr>
<tr>
<td style="text-align:center"><strong>Creator</strong></td>
<td><a href="https://twitter.com/darkstar7471">DarkStar7471</a></td>
</tr>
</tbody>
</table>
<h2 id="enumeration--">Enumeration -<a hidden class="anchor" aria-hidden="true" href="#enumeration--">#</a></h2>
<hr>
<p><strong>Task 1 - Pwn</strong></p>
<p><strong>Nmap</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Nmap 7.91 scan initiated Mon Aug  9 02:32:51 2021 as: nmap -sC -sV -v -p 80,3389 -oN retro.nmap retro.thm</span>
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> retro.thm <span class="o">(</span>10.10.39.189<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.22s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT     STATE SERVICE       VERSION
</span></span><span class="line"><span class="cl">80/tcp   open  http          Microsoft IIS httpd 10.0
</span></span><span class="line"><span class="cl"><span class="p">|</span> http-methods: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   Supported Methods: OPTIONS TRACE GET HEAD POST
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  Potentially risky methods: TRACE
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: Microsoft-IIS/10.0
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: IIS Windows Server
</span></span><span class="line"><span class="cl">3389/tcp open  ms-wbt-server Microsoft Terminal Services
</span></span><span class="line"><span class="cl"><span class="p">|</span> rdp-ntlm-info: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   Target_Name: RETROWEB
</span></span><span class="line"><span class="cl"><span class="p">|</span>   NetBIOS_Domain_Name: RETROWEB
</span></span><span class="line"><span class="cl"><span class="p">|</span>   NetBIOS_Computer_Name: RETROWEB
</span></span><span class="line"><span class="cl"><span class="p">|</span>   DNS_Domain_Name: RetroWeb
</span></span><span class="line"><span class="cl"><span class="p">|</span>   DNS_Computer_Name: RetroWeb
</span></span><span class="line"><span class="cl"><span class="p">|</span>   Product_Version: 10.0.14393
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  System_Time: 2021-08-09T06:32:02+00:00
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>RetroWeb
</span></span><span class="line"><span class="cl"><span class="p">|</span> Issuer: <span class="nv">commonName</span><span class="o">=</span>RetroWeb
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key type: rsa
</span></span><span class="line"><span class="cl"><span class="p">|</span> Public Key bits: <span class="m">2048</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> Signature Algorithm: sha256WithRSAEncryption
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid before: 2021-08-08T06:21:24
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid after:  2022-02-07T06:21:24
</span></span><span class="line"><span class="cl"><span class="p">|</span> MD5:   55a1 3e5f <span class="m">9623</span> 5cf0 be0e <span class="m">8565</span> b1bb 00a5
</span></span><span class="line"><span class="cl"><span class="p">|</span>_SHA-1: a0cf f59d 1e77 e914 7eeb 810e b04d a310 dc2c c90e
</span></span><span class="line"><span class="cl"><span class="p">|</span>_ssl-date: 2021-08-09T06:32:06+00:00<span class="p">;</span> -1m00s from scanner time.
</span></span><span class="line"><span class="cl">Service Info: OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host script results:
</span></span><span class="line"><span class="cl"><span class="p">|</span>_clock-skew: mean: -1m00s, deviation: 0s, median: -1m00s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Read data files from: /usr/bin/../share/nmap
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap done at Mon Aug  9 02:33:06 2021 -- 1 IP address (1 host up) scanned in 15.70 seconds</span>
</span></span></code></pre></div><p>As you can see there are 2 ports open :</p>
<p><strong>Port 80</strong> - <code>http </code> - <code> Microsoft IIS httpd 10.0</code></p>
<p><strong>Port 3389</strong> - <code>ms-wbt-server</code> -  <code>Microsoft Terminal Services</code></p>
<p><strong>Web Enumeration</strong></p>
<p>Visitinng the webpage at port 80, we get a <code>default IIS  page</code> üëáüèª</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1628496207799/WpfvKksHP.png" alt="image.png"  />
</p>
<p>To enumerate the hidden directories , I used <strong>ffuf</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚îå‚îÄ‚îÄ<span class="o">(</span>shebu„âøkali<span class="o">)</span>-<span class="o">[</span>~/Desktop/thm/retro<span class="o">]</span>
</span></span><span class="line"><span class="cl">‚îî‚îÄ$ ffuf -c -w /usr/share/wordlists/dirbuster/medium.txt -u http://retro.thm/FUZZ -fc 403,404 -fs <span class="m">703</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        /<span class="s1">&#39;___\  /&#39;</span>___<span class="se">\ </span>          /<span class="err">&#39;</span>___<span class="se">\ </span>      
</span></span><span class="line"><span class="cl">       /<span class="se">\ \_</span>_/ /<span class="se">\ \_</span>_/  __  __  /<span class="se">\ \_</span>_/       
</span></span><span class="line"><span class="cl">       <span class="se">\ \ </span>,__<span class="se">\\</span> <span class="se">\ </span>,__<span class="se">\/\ \/\ \ \ \ </span>,__<span class="se">\ </span>     
</span></span><span class="line"><span class="cl">        <span class="se">\ \ \_</span>/ <span class="se">\ \ \_</span>/<span class="se">\ \ \_\ \ \ \ \_</span>/      
</span></span><span class="line"><span class="cl">         <span class="se">\ \_\ </span>  <span class="se">\ \_\ </span> <span class="se">\ \_</span>___/  <span class="se">\ \_\ </span>      
</span></span><span class="line"><span class="cl">          <span class="se">\/</span>_/    <span class="se">\/</span>_/   <span class="se">\/</span>___/    <span class="se">\/</span>_/       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       v1.3.1 Kali Exclusive &lt;<span class="m">3</span>
</span></span><span class="line"><span class="cl">________________________________________________
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> :: Method           : GET
</span></span><span class="line"><span class="cl"> :: URL              : http://retro.thm/FUZZ
</span></span><span class="line"><span class="cl"> :: Wordlist         : FUZZ: /usr/share/wordlists/dirbuster/medium.txt
</span></span><span class="line"><span class="cl"> :: Follow redirects : <span class="nb">false</span>
</span></span><span class="line"><span class="cl"> :: Calibration      : <span class="nb">false</span>
</span></span><span class="line"><span class="cl"> :: Timeout          : <span class="m">10</span>
</span></span><span class="line"><span class="cl"> :: Threads          : <span class="m">40</span>
</span></span><span class="line"><span class="cl"> :: Matcher          : Response status: 200,204,301,302,307,401,403,405
</span></span><span class="line"><span class="cl"> :: Filter           : Response status: 403,404
</span></span><span class="line"><span class="cl"> :: Filter           : Response size: <span class="m">703</span>
</span></span><span class="line"><span class="cl">________________________________________________
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">retro                   <span class="o">[</span>Status: 301, Size: 146, Words: 9, Lines: 2<span class="o">]</span>
</span></span></code></pre></div><p><strong>Qn 1 üéØ- What is the hidden directory which the website lives on?</strong> - <code>/retro </code></p>
<h2 id="shell-as-wade--">Shell as Wade -<a hidden class="anchor" aria-hidden="true" href="#shell-as-wade--">#</a></h2>
<hr>
<p>On visiting the <code>/retro</code> directory we get this webpage  üëáüèª</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1628497851032/m91ozeahl.png" alt="image.png"  />
</p>
<p>Seems like a fancy looking blog page .Taking a close look at the page , you can see that the author of the blog posts is <code>Wade</code></p>
<p><strong>Wade</strong> might possibly be a username which may come handy later .Lets note it down and enumerate further !</p>
<p>While looking at all the posts ,one particular post is quite interesting üëáüèª</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1628498192898/LmlCC_-F0.png" alt="image.png"  />
</p>
<p>This posts has some comments on it !</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1628498336717/tVhZoC5NM.png" alt="image.png"  />
</p>
<p>Could that be Wade&rsquo;s password? Let&rsquo;s try logging in using xfreerdp !</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">xfreerdp /u:wade /p:parzival /cert:ignore /v:retro.thm
</span></span></code></pre></div><p>And we&rsquo;re in !!</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1628498610359/qsqeJCwxd.png" alt="image.png"  />
</p>
<p>Grab the <code>user.txt</code>üö©</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1628498965342/8JUkfeIvh.png" alt="image.png"  />
</p>
<h2 id="shell-as-administrator--">Shell as administrator -<a hidden class="anchor" aria-hidden="true" href="#shell-as-administrator--">#</a></h2>
<hr>
<p>The first thing I checked was <strong>recycle bin</strong> , It contained <code>hhupd.exe</code> file .</p>
<blockquote>
<p>hhupd.exe is an executable file that is part of the Microsoft Press Computer-Lexikon program developed by Microsoft Press .</p>
</blockquote>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1628501313225/yrffg7Hay.png" alt="image.png"  />
</p>
<p>The next thing I noticed is there was <strong>Google Chrome</strong> shortcut in desktop which was weird !<br>
Opening Chrome , we could see that the author of the box has a bookmark called <strong>NVD-CVE-2019-1388</strong></p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1628499422018/d61jwREHl.png" alt="image.png"  />
</p>
<p>Maybe this is  what we need inorder to escalate out privileges to root !
So the CVE is <code>CVE-2019-1388</code></p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1628501345278/tt0bOdAxv.png" alt="image.png"  />
</p>
<p>Lets use some google fu to read more on this vulnerability ,</p>
<p><strong>This blog post explains it in quite detailed and clear manner on how to exploit this vulnerability -</strong></p>
<blockquote>
<p><a href="https://www.zerodayinitiative.com/blog/2019/11/19/thanksgiving-treat-easy-as-pie-windows-7-secure-desktop-escalation-of-privilege">https://www.zerodayinitiative.com/blog/2019/11/19/thanksgiving-treat-easy-as-pie-windows-7-secure-desktop-escalation-of-privilege</a></p>
</blockquote>
<p>For this exploit to work we need to have <code>hhupd.exe</code> application on our system , which we already found in recycle bin .Restore the application and follow the steps as mentioned in the blog post .</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">1. Run the <span class="s2">&#34;hhupd.exe&#34;</span> application as administrator
</span></span><span class="line"><span class="cl">2. Click on <span class="s2">&#34;Show more details&#34;</span> arrow
</span></span><span class="line"><span class="cl">3. Click the link <span class="s2">&#34;Show information about this publisher&#39;s certificate&#34;</span>
</span></span><span class="line"><span class="cl">4. Click the link  <span class="s2">&#34;VeriSign Commercial Software Publishers CA&#34;</span>
</span></span><span class="line"><span class="cl">5. Now the certificate issuer<span class="err">&#39;</span>s website should have been opened on internet explorer!
</span></span><span class="line"><span class="cl">6. Press <span class="s2">&#34;CTRL+S&#34;</span> to save the webpage , a dialog box appears 
</span></span><span class="line"><span class="cl">7. Type <span class="s2">&#34;cmd.exe&#34;</span> on the File name box and hit ENTER !
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Voila ! We get a <span class="nb">command</span> prompt with admin privileges !
</span></span></code></pre></div><p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1628500476774/rBOSJ3Uvo.png" alt="image.png"  />
</p>
<p>Navigate to <strong>C:\Users\Administrator\Desktop</strong></p>
<p>Grab the <code>root.txt</code> üö©</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1628500633111/FE7yJpFOJ.png" alt="image.png"  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://sh3bu.github.io/tags/iis/">IIS</a></li>
      <li><a href="https://sh3bu.github.io/tags/cve-2019-1388/">CVE-2019-1388</a></li>
      <li><a href="https://sh3bu.github.io/tags/xfreerdp/">xfreerdp</a></li>
      <li><a href="https://sh3bu.github.io/tags/tryhackme/">tryhackme</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://sh3bu.github.io/posts/hackpark/">
    <span class="title">¬´ Prev</span>
    <br>
    <span>HackPark - THM</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Retro - THM on twitter"
        href="https://twitter.com/intent/tweet/?text=Retro%20-%20THM&amp;url=https%3a%2f%2fsh3bu.github.io%2fposts%2fretro%2f&amp;hashtags=IIS%2cCVE-2019-1388%2cxfreerdp%2ctryhackme">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Retro - THM on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsh3bu.github.io%2fposts%2fretro%2f&amp;title=Retro%20-%20THM&amp;summary=Retro%20-%20THM&amp;source=https%3a%2f%2fsh3bu.github.io%2fposts%2fretro%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Retro - THM on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fsh3bu.github.io%2fposts%2fretro%2f&title=Retro%20-%20THM">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Retro - THM on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsh3bu.github.io%2fposts%2fretro%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Retro - THM on whatsapp"
        href="https://api.whatsapp.com/send?text=Retro%20-%20THM%20-%20https%3a%2f%2fsh3bu.github.io%2fposts%2fretro%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Retro - THM on telegram"
        href="https://telegram.me/share/url?text=Retro%20-%20THM&amp;url=https%3a%2f%2fsh3bu.github.io%2fposts%2fretro%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://sh3bu.github.io/">Shebu</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
