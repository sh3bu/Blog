<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Traverxec - HTB | Shebu ðŸ”½</title>
<meta name="keywords" content="nostromo, ssh2john, pspy, gtfobins, journelctl">
<meta name="description" content="Summary - Traverxec is a easy rated machine from hackthebox which involves a public exploit for nostromo web server by which we gain a foothold on the box . On the machine there&rsquo;s a user called david .We find an id_rsa key of David in one of the directories &amp; thus escalating our privileges to David. For root, we make use of a sudo misconfiguration on journelctl binary to escalate our privileges to root !">
<meta name="author" content="Shebu">
<link rel="canonical" href="https://sh3bu.github.io/themes/hugo-PaperMod/posts/traverxec/">
<link crossorigin="anonymous" href="/themes/hugo-PaperMod/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css" integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe&#43;FVUFzPh7U=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/themes/hugo-PaperMod/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://sh3bu.github.io/themes/hugo-PaperMod/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://sh3bu.github.io/themes/hugo-PaperMod/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://sh3bu.github.io/themes/hugo-PaperMod/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://sh3bu.github.io/themes/hugo-PaperMod/apple-touch-icon.png">
<link rel="mask-icon" href="https://sh3bu.github.io/themes/hugo-PaperMod/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Traverxec - HTB" />
<meta property="og:description" content="Summary - Traverxec is a easy rated machine from hackthebox which involves a public exploit for nostromo web server by which we gain a foothold on the box . On the machine there&rsquo;s a user called david .We find an id_rsa key of David in one of the directories &amp; thus escalating our privileges to David. For root, we make use of a sudo misconfiguration on journelctl binary to escalate our privileges to root !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sh3bu.github.io/themes/hugo-PaperMod/posts/traverxec/" />
<meta property="og:image" content="https://sh3bu.github.io/themes/hugo-PaperMod/img/traverxec.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-11-17T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://sh3bu.github.io/themes/hugo-PaperMod/img/traverxec.png" />
<meta name="twitter:title" content="Traverxec - HTB"/>
<meta name="twitter:description" content="Summary - Traverxec is a easy rated machine from hackthebox which involves a public exploit for nostromo web server by which we gain a foothold on the box . On the machine there&rsquo;s a user called david .We find an id_rsa key of David in one of the directories &amp; thus escalating our privileges to David. For root, we make use of a sudo misconfiguration on journelctl binary to escalate our privileges to root !"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://sh3bu.github.io/themes/hugo-PaperMod/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Traverxec - HTB",
      "item": "https://sh3bu.github.io/themes/hugo-PaperMod/posts/traverxec/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Traverxec - HTB",
  "name": "Traverxec - HTB",
  "description": "Summary - Traverxec is a easy rated machine from hackthebox which involves a public exploit for nostromo web server by which we gain a foothold on the box . On the machine there\u0026rsquo;s a user called david .We find an id_rsa key of David in one of the directories \u0026amp; thus escalating our privileges to David. For root, we make use of a sudo misconfiguration on journelctl binary to escalate our privileges to root !",
  "keywords": [
    "nostromo", "ssh2john", "pspy", "gtfobins", "journelctl"
  ],
  "articleBody": "Summary - Traverxec is a easy rated machine from hackthebox which involves a public exploit for nostromo web server by which we gain a foothold on the box . On the machine thereâ€™s a user called david .We find an id_rsa key of David in one of the directories \u0026 thus escalating our privileges to David. For root, we make use of a sudo misconfiguration on journelctl binary to escalate our privileges to root !\nName - Traverxec OS - Linux Difficulty - Easy Room Link - https://www.hackthebox.eu/home/machines/profile/217 Creator - jkr Enumeration - Nmap\n# Nmap 7.91 scan initiated Thu Jul 15 13:18:21 2021 as: nmap -sC -sV -v -p 22,80 -oN traverxec.nmap 10.10.10.165 Nmap scan report for 10.10.10.165 Host is up (0.38s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0) | ssh-hostkey: | 2048 aa:99:a8:16:68ðŸ’¿41:cc:f9:6c:84:01:c7:59:09:5c (RSA) | 256 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc (ECDSA) |_ 256 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:ce (ED25519) 80/tcp open http nostromo 1.9.6 |_http-favicon: Unknown favicon MD5: FED84E16B6CCFE88EE7FFAAE5DFEFD34 | http-methods: |_ Supported Methods: GET HEAD POST |_http-server-header: nostromo 1.9.6 |_http-title: TRAVERXEC Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Thu Jul 15 13:18:39 2021 -- 1 IP address (1 host up) scanned in 18.13 seconds As you can see there are 2 ports open :\nPort 22 - SSH - OpenSSH 7.9p1 Debian 10+deb10u1 Port 80 - HTTP - nostromo 1.9.6\nWebsite - Port 80\nAs the nmap scan showed ,the website isrunning on nostromo web server of version 1.9.6 , lets look for public exploits for this version using searchsploit .\nAnd we have a remote code execution vulnerability for this version of nostromo. I had some issues with python2 when solving the box so I had to use metasploit this time.\nOpen msfconsole and search for nostromo \u0026 you will get this exploit .\nFoothold - Lets use the metasploit module . Set the LHOST,RHOST,RPORT \u0026 other parameters needed for the exploit to work and finally run the exploit .\nAnd we are in as www-data user !\nViewing /etc/passwd tells us there is a user called David\ncat /etc/passwd |grep -i \"bash\" Shell as David - I ran Linpeas to check for any interesting files or any priv-esc vectors , it displayed an md5crypt password hash of David\nI used hashcat to crack it\nhashcat -m 500 htpasswd /usr/share/wordlists/rockyou.txt --username --force Now we have this - david:Nowonly4me .\nBut this password doesnâ€™t seem to help as I couldnâ€™t ssh into the machine as David.\nTime for some manual enumeration!\nLets look for any files from nostromo web server ,\nIn /var , we see a directory called nostromo .Lets enumerate that directory as it might contain some juicy information.\nLooking at /var/nostromo/conf/.htpasswd - we have that hash which linpeas found for us .\nIn the /var/nostromo/conf/nhttpd.conf we have these contents which seems interesting!\nAfter reading the documentation of nostromo , I came to know that homedirs serve as the home directories of the user.\nSo under davidâ€™s home directory we have a public directory called public_www.Lets lists the contents of this directory\nWe find that there is another directory within it called protected-file-area.Lets list the contents of that directory now ,\nWe have 2 files .htaccess \u0026 backup-ssh-identity-files.tgz .The tar file seems interesting .Lets copy it to /dev/shm and lets extract the contents of the tar archive.\nWe can see we have id_rsa key from the extracted files,lets copy that to our machine .\nIt is encrypted hence we will use ssh2john to extract a hash of it and then crack it using rockyou wordlist !\nssh2john id_rsa \u003e hash john --wordlist=/usr/share/wordlists/rockyou.txt hash And we have the password .Make sure to give correct permissions to id_rsa \u0026 now lets SSH into the machine as David\nGrab the user.txt ðŸš©\nShell as Root - Running Linpeas ,we find that we have a shell script called server-status.sh\nI checked if there are any cronjobs running which executes this script \u0026 there wasnâ€™t any. I even used pspy to check for any cronjobs run by root which were not visible to us. And still we find nothing .\nOK .lets check the contents of the file .\n#!/bin/bash cat /home/david/bin/server-stats.head echo \"Load: `/usr/bin/uptime`\" echo \" \" echo \"Open nhttpd sockets: `/usr/bin/ss -H sport = 80 | /usr/bin/wc -l`\" echo \"Files in the docroot: `/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc -l`\" echo \" \" echo \"Last 5 journal log lines:\" /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service | /usr/bin/cat The last line seems weird . Journelctl is run with sudo .\nJournalctl is a utility for querying and displaying logs from journald, systemdâ€™s logging service. Since journald stores log data in a binary format instead of a plaintext format, journalctl is the standard way of reading log messages processed by journald\nBut the key thing here is the sudo rule breaks when a pipe command is introduced.Meaning that **any command after pipe will not be executed with sudo permissions ! **'\nSo in the last line only /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service is executed with sudo permissions and not /usr/bin/cat .\nLets check GTFOBINS for any sudo misconfiguration in journelctl to escalate our privileges.\nSteps - Run the command\n/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service Type !/bin/sh \u0026 hit ENTER .\nWOHOO ! We are root !\nGrab the root.txt ðŸš©\n",
  "wordCount" : "893",
  "inLanguage": "en",
  "image":"https://sh3bu.github.io/themes/hugo-PaperMod/img/traverxec.png","datePublished": "2021-11-17T00:00:00Z",
  "dateModified": "2021-11-17T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Shebu"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sh3bu.github.io/themes/hugo-PaperMod/posts/traverxec/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Shebu ðŸ”½",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sh3bu.github.io/themes/hugo-PaperMod/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://sh3bu.github.io/themes/hugo-PaperMod" accesskey="h" title="Shebu ðŸ”½ (Alt + H)">Shebu ðŸ”½</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://sh3bu.github.io/themes/hugo-PaperMod/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://sh3bu.github.io/themes/hugo-PaperMod/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://sh3bu.github.io/themes/hugo-PaperMod/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://sh3bu.github.io/themes/hugo-PaperMod">Home</a>&nbsp;Â»&nbsp;<a href="https://sh3bu.github.io/themes/hugo-PaperMod/posts/">Posts</a></div>
    <h1 class="post-title">
      Traverxec - HTB
    </h1>
    <div class="post-meta"><span title='2021-11-17 00:00:00 +0000 UTC'>November 17, 2021</span>&nbsp;Â·&nbsp;5 min&nbsp;Â·&nbsp;Shebu

</div>
  </header> 
<figure class="entry-cover">
        <img loading="lazy" srcset="https://sh3bu.github.io/themes/hugo-PaperMod/posts/traverxec/img/traverxec_hub02bd4bc54fe0983fc7bc015b4ddbe04_80236_360x0_resize_box_3.png 360w ,https://sh3bu.github.io/themes/hugo-PaperMod/posts/traverxec/img/traverxec.png 429w" 
            sizes="(min-width: 768px) 720px, 100vw" src="https://sh3bu.github.io/themes/hugo-PaperMod/posts/traverxec/img/traverxec.png" alt="" 
            width="429" height="248">
        <p><text></p>
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#summary--" aria-label="Summary -">Summary -</a></li>
                <li>
                    <a href="#enumeration--" aria-label="Enumeration -">Enumeration -</a></li>
                <li>
                    <a href="#foothold--" aria-label="Foothold -">Foothold -</a></li>
                <li>
                    <a href="#shell-as-david--" aria-label="Shell as David -">Shell as David -</a></li>
                <li>
                    <a href="#shell-as-root--" aria-label="Shell as Root -">Shell as Root -</a><ul>
                        
                <li>
                    <a href="#steps--" aria-label="Steps -"><em>Steps</em> -</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="summary--">Summary -<a hidden class="anchor" aria-hidden="true" href="#summary--">#</a></h2>
<p>Traverxec is a easy rated machine from hackthebox which involves a public exploit for nostromo web server by which we gain a foothold on the box . On the machine there&rsquo;s a user called <code>david</code> .We find an id_rsa key of David in one of the directories  &amp; thus escalating our privileges to David. For root, we make use of a sudo misconfiguration on journelctl binary to escalate our privileges to root !</p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>Name  -</strong></th>
<th>Traverxec</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>OS   -</strong></td>
<td>Linux</td>
</tr>
<tr>
<td style="text-align:center"><strong>Difficulty -</strong></td>
<td>Easy</td>
</tr>
<tr>
<td style="text-align:center"><strong>Room Link   -</strong></td>
<td><a href="https://www.hackthebox.eu/home/machines/profile/217">https://www.hackthebox.eu/home/machines/profile/217</a></td>
</tr>
<tr>
<td style="text-align:center"><strong>Creator   -</strong></td>
<td><a href="https://www.hackthebox.eu/home/users/profile/77141">jkr</a></td>
</tr>
</tbody>
</table>
<h2 id="enumeration--">Enumeration -<a hidden class="anchor" aria-hidden="true" href="#enumeration--">#</a></h2>
<hr>
<p><strong>Nmap</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl"><span class="c1"># Nmap 7.91 scan initiated Thu Jul 15 13:18:21 2021 as: nmap -sC -sV -v -p 22,80 -oN traverxec.nmap 10.10.10.165</span>
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.10.165
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.38s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 <span class="o">(</span>protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssh-hostkey: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">2048</span> aa:99:a8:16:68ðŸ’¿41:cc:f9:6c:84:01:c7:59:09:5c <span class="o">(</span>RSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">256</span> 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc <span class="o">(</span>ECDSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  <span class="m">256</span> 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:ce <span class="o">(</span>ED25519<span class="o">)</span>
</span></span><span class="line"><span class="cl">80/tcp open  http    nostromo 1.9.6
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-favicon: Unknown favicon MD5: FED84E16B6CCFE88EE7FFAAE5DFEFD34
</span></span><span class="line"><span class="cl"><span class="p">|</span> http-methods: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  Supported Methods: GET HEAD POST
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: nostromo 1.9.6
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: TRAVERXEC
</span></span><span class="line"><span class="cl">Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Read data files from: /usr/bin/../share/nmap
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap done at Thu Jul 15 13:18:39 2021 -- 1 IP address (1 host up) scanned in 18.13 seconds</span>
</span></span></code></pre></div><p>As you can see there are 2 ports open :</p>
<p><strong>Port 22</strong>  - <code>SSH</code>    - <code>OpenSSH 7.9p1 Debian 10+deb10u1 </code></p>
<p><strong>Port 80</strong>  - <code>HTTP</code>  - <code>nostromo 1.9.6</code></p>
<p><strong>Website - Port 80</strong></p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626501511759/wGzYtNhut.png" alt="image.png"  />
</p>
<p>As the nmap scan showed ,the website isrunning on <code>nostromo</code>  web server of <code>version 1.9.6</code> , lets look for public exploits for this version using searchsploit .</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626501650018/0r0mODJGa.png" alt="image.png"  />
</p>
<p>And we have a <code>remote code execution</code> vulnerability for this version of nostromo.
I had some issues with python2 when solving the box so I had to use metasploit  this time.</p>
<p>Open msfconsole and search for nostromo &amp; you will get this exploit .</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626501886372/qXzvevdRR.png" alt="image.png"  />
</p>
<h2 id="foothold--">Foothold -<a hidden class="anchor" aria-hidden="true" href="#foothold--">#</a></h2>
<hr>
<p>Lets use the metasploit module . Set the LHOST,RHOST,RPORT &amp; other parameters needed  for the exploit to work and finally run the exploit .</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626502025094/zSIi3oFaI.png" alt="image.png"  />
</p>
<p>And we are in as <code>www-data</code> user  !</p>
<p>Viewing <code>/etc/passwd</code> tells us there is a user called <code>David</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat /etc/passwd <span class="p">|</span>grep -i <span class="s2">&#34;bash&#34;</span>
</span></span></code></pre></div><p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626502184080/OLZ0T6ih4.png" alt="image.png"  />
</p>
<h2 id="shell-as-david--">Shell as David -<a hidden class="anchor" aria-hidden="true" href="#shell-as-david--">#</a></h2>
<hr>
<p>I ran Linpeas to check for any interesting files or any priv-esc vectors , it displayed an md5crypt password  hash of David</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626502540277/pFTAF4_TW.png" alt="image.png"  />
</p>
<p>I used hashcat to crack it</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hashcat -m <span class="m">500</span> htpasswd /usr/share/wordlists/rockyou.txt --username --force
</span></span></code></pre></div><p>Now we have this - <code>david:Nowonly4me</code> .</p>
<p><strong>But this password doesn&rsquo;t seem to help as I couldn&rsquo;t ssh into the machine as David.</strong></p>
<p>Time for some manual enumeration!</p>
<p>Lets look for any files from nostromo web server ,</p>
<p>In <code>/var</code> , we see a directory called <strong>nostromo</strong> .Lets enumerate that directory as it might contain some juicy information.</p>
<p>Looking at <code>/var/nostromo/conf/.htpasswd</code> - we have that hash which linpeas found for us .</p>
<p>In the <code>/var/nostromo/conf/nhttpd.conf</code> we have these contents which seems interesting!</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626502964249/2m1cEL5hT.png" alt="image.png"  />
</p>
<p>After reading the documentation of nostromo , I came to know that <strong>homedirs serve as the home directories of the user</strong>.</p>
<p><strong>So under david&rsquo;s home directory we have a public directory called <code>public_www</code></strong>.Lets lists the contents of this directory</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626503406080/dxHW0QMQk.png" alt="image.png"  />
</p>
<p>We find that there is another directory within it called <code>protected-file-area</code>.Lets list the contents  of that directory now ,</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626503551130/5LiHP0T7D.png" alt="image.png"  />
</p>
<p>We have 2 files <code>.htaccess</code> &amp; <code>backup-ssh-identity-files.tgz</code> .The tar file seems interesting .Lets copy it to /dev/shm and lets extract the contents of the tar archive.</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626503793599/BbXESSW2v.png" alt="image.png"  />
</p>
<p>We can see we have id_rsa key from the extracted files,lets copy that to our machine .</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626504653363/CdZ50MkD3.png" alt="image.png"  />

It is encrypted hence we will use <code>ssh2john</code> to extract a hash of it and then crack it using rockyou wordlist !</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> ssh2john id_rsa &gt; <span class="nb">hash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">john --wordlist<span class="o">=</span>/usr/share/wordlists/rockyou.txt <span class="nb">hash</span>
</span></span></code></pre></div><p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626504849405/m16iIFs5B.png" alt="image.png"  />
</p>
<p>And we have the password .Make sure to give correct permissions to id_rsa &amp; now lets SSH into the machine as <strong>David</strong></p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626505593907/t2P8pyPFg.png" alt="image.png"  />
</p>
<p>Grab the <code>user.txt</code> ðŸš©</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626507874305/8yczE0Fxn.png" alt="image.png"  />
</p>
<h2 id="shell-as-root--">Shell as Root -<a hidden class="anchor" aria-hidden="true" href="#shell-as-root--">#</a></h2>
<hr>
<p>Running Linpeas ,we find that we have a shell script called <code>server-status.sh</code></p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626505711907/SNmVcu7X-.png" alt="image.png"  />
</p>
<p>I checked if there are any cronjobs running which executes this script &amp; there wasn&rsquo;t any. I even used <strong>pspy</strong> to check for any cronjobs run by root which were not visible to us. And still we find nothing .</p>
<p>OK .lets check the contents of the file .</p>
<pre tabindex="0"><code>#!/bin/bash
cat /home/david/bin/server-stats.head
echo &#34;Load: `/usr/bin/uptime`&#34;
echo &#34; &#34;
echo &#34;Open nhttpd sockets: `/usr/bin/ss -H sport = 80 | /usr/bin/wc -l`&#34;
echo &#34;Files in the docroot: `/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc -l`&#34;
echo &#34; &#34;
echo &#34;Last 5 journal log lines:&#34;
/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service | /usr/bin/cat 
</code></pre><p>The last line seems weird . <strong>Journelctl is run with sudo</strong>  .</p>
<blockquote>
<p>Journalctl is a utility for querying and displaying logs from journald, systemd&rsquo;s logging service. Since journald stores log data in a binary format instead of a plaintext format, journalctl is the standard way of reading log messages processed by journald</p>
</blockquote>
<p>But the key thing here is the sudo rule breaks when a pipe command is introduced.Meaning that **any command after  pipe will not be executed with sudo permissions ! **'</p>
<p>So in the last line only <code>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</code> is executed with sudo permissions and not <code>/usr/bin/cat</code> .</p>
<p>Lets check   <a href="https://gtfobins.github.io/gtfobins/journalctl/">GTFOBINS</a>  for any <strong>sudo misconfiguration in journelctl</strong> to escalate our privileges.</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626507057730/7zgDvi3uN.png" alt="image.png"  />
</p>
<h3 id="steps--"><em>Steps</em> -<a hidden class="anchor" aria-hidden="true" href="#steps--">#</a></h3>
<p>Run the command</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service
</span></span></code></pre></div><p>Type <code>!/bin/sh</code> &amp; hit ENTER .</p>
<p>WOHOO ! We are <strong>root</strong> !</p>
<p>Grab the <code>root.txt</code> ðŸš©</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1626507547001/kUzsPWRe0c.png" alt="image.png"  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://sh3bu.github.io/themes/hugo-PaperMod/tags/nostromo/">nostromo</a></li>
      <li><a href="https://sh3bu.github.io/themes/hugo-PaperMod/tags/ssh2john/">ssh2john</a></li>
      <li><a href="https://sh3bu.github.io/themes/hugo-PaperMod/tags/pspy/">pspy</a></li>
      <li><a href="https://sh3bu.github.io/themes/hugo-PaperMod/tags/gtfobins/">gtfobins</a></li>
      <li><a href="https://sh3bu.github.io/themes/hugo-PaperMod/tags/journelctl/">journelctl</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://sh3bu.github.io/themes/hugo-PaperMod/posts/openadmin/">
    <span class="title">Â« Prev</span>
    <br>
    <span>Openadmin - HTB</span>
  </a>
  <a class="next" href="https://sh3bu.github.io/themes/hugo-PaperMod/posts/dailybugle/">
    <span class="title">Next Â»</span>
    <br>
    <span>Daily Bugle - THM</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Traverxec - HTB on twitter"
        href="https://twitter.com/intent/tweet/?text=Traverxec%20-%20HTB&amp;url=https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2ftraverxec%2f&amp;hashtags=nostromo%2cssh2john%2cpspy%2cgtfobins%2cjournelctl">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Traverxec - HTB on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2ftraverxec%2f&amp;title=Traverxec%20-%20HTB&amp;summary=Traverxec%20-%20HTB&amp;source=https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2ftraverxec%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Traverxec - HTB on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2ftraverxec%2f&title=Traverxec%20-%20HTB">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Traverxec - HTB on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2ftraverxec%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Traverxec - HTB on whatsapp"
        href="https://api.whatsapp.com/send?text=Traverxec%20-%20HTB%20-%20https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2ftraverxec%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Traverxec - HTB on telegram"
        href="https://telegram.me/share/url?text=Traverxec%20-%20HTB&amp;url=https%3a%2f%2fsh3bu.github.io%2fthemes%2fhugo-PaperMod%2fposts%2ftraverxec%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://sh3bu.github.io/themes/hugo-PaperMod">Shebu ðŸ”½</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
